# My NixOS Setup
This repo contains the configuration files for my continuously evolving personal multi-pc NixOS setup

I am pretty new to Nix, and my configuration is still WIP. If you have any doubts or suggestion, feel free to open an issue

![desktop](./src/desktop.png)

## Programs
| Type                | Program                     |
| :------------------ | :-------------------------: |
| Editor              | [gEdit](https://neovim.io/) |
| Shell               | [ZSH](https://www.zsh.org/) |
| Terminal            | [GNOME Terminal](https://gitlab.gnome.org/GNOME/gnome-terminal) |
| Desktop Environment | [GNOME](https://www.gnome.org/) |

## Structure

Here is an overview of the folders' structure:

```
┌── configuration.nix
├── secrets
├── setup.sh
├── overlays
│   ├── patches
│   └── packages
├── volatile
│   ├── repos
│   ├── path
│   └── device.nix
├── users
│   ├── v7
│   │   ├── config
│   │   ├── modules
│   │   └── overlays
│   └── root
└── modules
    ├── devices
    │   ├── vortex
    │   │   ├── hardware.nix
    │   │   ├── boot.nix
    │   │   └── services.nix
    │   └── futura
    │       ├── hardware.nix
    │       └── boot.nix
    ├── gui.nix
    ├── partitions.nix
    ├── packages.nix
    └── programs.nix
```

- `configuration.nix`: main system derivation file
- `setup.sh`: initial setup and installation script
- `device.nix`: device-specific configuration generated by setup script
- `path`: path to system configuration files generated by setup script
- `volatile`: directory containing variable information
- `repos`: management and versioning for repos
- `users`: user related configuration and dotfiles
- `modules`: modulated configuration for easier management
- `overlays`: overrides for pre-built packages
- `packages`: locally built custom packages

## Installation
Install NixOS using the following commands:  
*Note that the partition label along with the `esp` and `boot` flags must be set on the EFI System Partition*
<pre><code>mkfs.ext4 -L System <i>/path/to/root</i>
mkswap -L swap <i>/path/to/swap</i>
mkfs.fat -F 32 -n boot <i>/path/to/esp</i>
mount /dev/disk/by-label/System /mnt
mkdir -p /mnt/boot/efi
mount /dev/disk/by-partlabel/boot /mnt/boot/efi
nixos-generate-config --root /mnt
nixos-install
</code></pre>

After rebooting, run the following commands:
<pre><code>mkdir temp && cd temp
git clone --recurse-submodules https://github.com/maydayv7/nixos-config.git && cd nixos-config
git-crypt unlock <i>/path/to/key</i>
chmod +x setup.sh && ./setup.sh
</code></pre>
And follow the instructions to setup and rebuild the system

## Notes
#### Requirements
+ Intel CPU + iGPU
+ UEFI System (for use with GRUB EFI Bootloader)

#### Encryption
The contents of `secrets` is encrypted is using `git-crypt`. It is the location where sensitive information and authentication credentials are stored

#### Important Links

+ [NixOS Manual](https://nixos.org/manual/nixpkgs/stable)
+ [NixOS Discourse](https://discourse.nixos.org/)
+ [NixOS Package Search](https://search.nixos.org/)
+ [NixPkgs Repo](https://github.com/NixOS/nixpkgs)
+ [Nix User Repository](https://github.com/nix-community/NUR)
+ [home-manager Options](https://rycee.gitlab.io/home-manager/options.html)